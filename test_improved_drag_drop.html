<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Improved Drag & Drop Test - CMRP Proposal Workbench</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="filter-fixes.css">
    <style>
        /* Test-specific styles to highlight drop zones */
        .test-highlight {
            border: 2px solid red !important;
            background-color: rgba(255, 0, 0, 0.1) !important;
        }
        
        .drop-zone-indicator {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            border: 2px dashed rgba(0, 255, 0, 0.5);
            background-color: rgba(0, 255, 0, 0.05);
            pointer-events: none;
            z-index: 10;
            display: none;
        }
        
        .kanban-column:hover .drop-zone-indicator {
            display: block;
        }
        
        .test-info {
            background: #f0f9ff;
            border: 1px solid #0ea5e9;
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
            color: #0c4a6e;
        }
    </style>
</head>
<body class="bg-blue-600">
            <div class="test-info">
            <h3>üß™ Enhanced Kanban Board Test</h3>
            <p><strong>What to test:</strong></p>
            <ul>
                <li>‚úÖ <strong>Drag & Drop:</strong> Drag cards from any column to any other column (especially when submitted list is long)</li>
                <li>‚úÖ <strong>Drop Zones:</strong> Drop zones should work even when hovering over empty column areas</li>
                <li>‚úÖ <strong>Visual Feedback:</strong> Visual feedback should appear when dragging over entire column</li>
                <li>‚úÖ <strong>Empty Columns:</strong> "Drop proposals here" text should appear in empty columns</li>
                <li>‚úÖ <strong>Ultra-Compact Columns:</strong> Columns limited to 250px max height to ensure calendar visibility</li>
                <li>‚úÖ <strong>Last 10 Toggle:</strong> "Last 10 only" toggle should limit submitted proposals to most recent 10</li>
            </ul>
            <p><strong>New improvements:</strong> Ultra-compact scrollable columns (250px max), "Last 10 only" enabled by default, calendar always visible</p>
        </div>

    <div class="container mx-auto px-4 py-6">
        <header class="simple-header mb-6">
            <div class="flex items-center">
                <img src="Logo/CMRP Logo Light.svg" alt="CMRP Logo" class="h-8 w-auto mr-3">
                <h1 class="text-xl font-bold">Proposal Workbench - Drag & Drop Test</h1>
            </div>
            <div class="flex items-center space-x-4">
                <button id="themeToggle" class="nav-square-btn">
                    <span class="material-icons">wb_sunny</span>
                </button>
            </div>
        </header>

        <!-- Filters -->
        <div class="mb-6 flex items-center space-x-4">
            <div class="flex items-center gap-2">
                <label for="picFilter" class="filter-label text-sm font-medium">PIC:</label>
                <select id="picFilter" class="filter-dropdown">
                    <option value="">All PICs</option>
                </select>
            </div>
            <div class="flex items-center gap-2">
                <label for="clientFilter" class="filter-label text-sm font-medium">Client:</label>
                <select id="clientFilter" class="filter-dropdown">
                    <option value="">All Clients</option>
                </select>
            </div>
            <div class="flex items-center gap-2">
                <label for="accountManagerFilter" class="filter-label text-sm font-medium">Account Manager:</label>
                <select id="accountManagerFilter" class="filter-dropdown">
                    <option value="">All Account Managers</option>
                </select>
            </div>
            <div class="flex items-center gap-2">
                <input type="checkbox" id="hideOldSubmitted" class="mr-1" checked>
                <label for="hideOldSubmitted" class="filter-label text-sm font-medium">Last 10 submitted only</label>
            </div>
        </div>

        <!-- Main Workflow Row -->
        <div class="mb-6">
            <h2 class="text-xl font-bold mb-4 text-gray-900 dark:text-white">üìã Main Workflow</h2>
            <div id="kanbanBoard" class="kanban-board grid grid-cols-4 gap-4">
                <!-- Not Yet Started -->
                <div id="notStartedColumn" class="kanban-column bg-white dark:bg-gray-700 rounded-lg shadow">
                    <div class="drop-zone-indicator"></div>
                    <div class="kanban-column-header bg-gray-500 text-white p-3 rounded-t-lg">
                        <h3 class="font-semibold">Not Yet Started</h3>
                        <span class="bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-gray-200 px-2 py-1 rounded-full text-xs" id="notStartedCount">0</span>
                    </div>
                    <div id="notStartedBody" class="kanban-column-body p-2 min-h-48"></div>
                </div>

                <!-- On-going -->
                <div id="ongoingColumn" class="kanban-column bg-white dark:bg-gray-700 rounded-lg shadow">
                    <div class="drop-zone-indicator"></div>
                    <div class="kanban-column-header bg-amber-500 text-white p-3 rounded-t-lg">
                        <h3 class="font-semibold">On-going</h3>
                        <span class="bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-gray-200 px-2 py-1 rounded-full text-xs" id="ongoingCount">0</span>
                    </div>
                    <div id="ongoingBody" class="kanban-column-body p-2 min-h-48"></div>
                </div>

                <!-- For Approval -->
                <div id="forApprovalColumn" class="kanban-column bg-white dark:bg-gray-700 rounded-lg shadow">
                    <div class="drop-zone-indicator"></div>
                    <div class="kanban-column-header bg-blue-500 text-white p-3 rounded-t-lg">
                        <h3 class="font-semibold">For Approval</h3>
                        <span class="bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-gray-200 px-2 py-1 rounded-full text-xs" id="forApprovalCount">0</span>
                    </div>
                    <div id="forApprovalBody" class="kanban-column-body p-2 min-h-48"></div>
                </div>

                <!-- Submitted -->
                <div id="submittedColumn" class="kanban-column bg-white dark:bg-gray-700 rounded-lg shadow">
                    <div class="drop-zone-indicator"></div>
                    <div class="kanban-column-header bg-emerald-500 text-white p-3 rounded-t-lg">
                        <h3 class="font-semibold">Submitted</h3>
                        <span class="bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-gray-200 px-2 py-1 rounded-full text-xs" id="submittedCount">0</span>
                    </div>
                    <div id="submittedBody" class="kanban-column-body p-2 min-h-48">
                        <!-- This will have many cards to test long column scrolling -->
                        <div class="proposal-card bg-white dark:bg-gray-900/50 p-3 mb-2 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 cursor-grab" draggable="true" data-proposal-id="test1">
                            <div class="font-medium text-gray-900 dark:text-gray-100">Test Proposal 1</div>
                            <div class="text-sm text-gray-600 dark:text-gray-400">Client: Test Client A</div>
                            <div class="text-sm font-semibold text-gray-800 dark:text-gray-200">$50,000</div>
                        </div>
                        <div class="proposal-card bg-white dark:bg-gray-900/50 p-3 mb-2 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 cursor-grab" draggable="true" data-proposal-id="test2">
                            <div class="font-medium text-gray-900 dark:text-gray-100">Test Proposal 2</div>
                            <div class="text-sm text-gray-600 dark:text-gray-400">Client: Test Client B</div>
                            <div class="text-sm font-semibold text-gray-800 dark:text-gray-200">$75,000</div>
                        </div>
                        <div class="proposal-card bg-white dark:bg-gray-900/50 p-3 mb-2 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 cursor-grab" draggable="true" data-proposal-id="test3">
                            <div class="font-medium text-gray-900 dark:text-gray-100">Test Proposal 3</div>
                            <div class="text-sm text-gray-600 dark:text-gray-400">Client: Test Client C</div>
                            <div class="text-sm font-semibold text-gray-800 dark:text-gray-200">$100,000</div>
                        </div>
                        <div class="proposal-card bg-white dark:bg-gray-900/50 p-3 mb-2 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 cursor-grab" draggable="true" data-proposal-id="test4">
                            <div class="font-medium text-gray-900 dark:text-gray-100">Test Proposal 4</div>
                            <div class="text-sm text-gray-600 dark:text-gray-400">Client: Test Client D</div>
                            <div class="text-sm font-semibold text-gray-800 dark:text-gray-200">$25,000</div>
                        </div>
                        <div class="proposal-card bg-white dark:bg-gray-900/50 p-3 mb-2 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 cursor-grab" draggable="true" data-proposal-id="test5">
                            <div class="font-medium text-gray-900 dark:text-gray-100">Test Proposal 5</div>
                            <div class="text-sm text-gray-600 dark:text-gray-400">Client: Test Client E</div>
                            <div class="text-sm font-semibold text-gray-800 dark:text-gray-200">$150,000</div>
                        </div>
                        <div class="proposal-card bg-white dark:bg-gray-900/50 p-3 mb-2 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 cursor-grab" draggable="true" data-proposal-id="test6">
                            <div class="font-medium text-gray-900 dark:text-gray-100">Test Proposal 6</div>
                            <div class="text-sm text-gray-600 dark:text-gray-400">Client: Test Client F</div>
                            <div class="text-sm font-semibold text-gray-800 dark:text-gray-200">$80,000</div>
                        </div>
                        <div class="proposal-card bg-white dark:bg-gray-900/50 p-3 mb-2 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 cursor-grab" draggable="true" data-proposal-id="test7">
                            <div class="font-medium text-gray-900 dark:text-gray-100">Test Proposal 7</div>
                            <div class="text-sm text-gray-600 dark:text-gray-400">Client: Test Client G</div>
                            <div class="text-sm font-semibold text-gray-800 dark:text-gray-200">$120,000</div>
                        </div>
                        <div class="proposal-card bg-white dark:bg-gray-900/50 p-3 mb-2 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 cursor-grab" draggable="true" data-proposal-id="test8">
                            <div class="font-medium text-gray-900 dark:text-gray-100">Test Proposal 8</div>
                            <div class="text-sm text-gray-600 dark:text-gray-400">Client: Test Client H</div>
                            <div class="text-sm font-semibold text-gray-800 dark:text-gray-200">$95,000</div>
                        </div>
                        <div class="proposal-card bg-white dark:bg-gray-900/50 p-3 mb-2 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 cursor-grab" draggable="true" data-proposal-id="test9">
                            <div class="font-medium text-gray-900 dark:text-gray-100">Test Proposal 9</div>
                            <div class="text-sm text-gray-600 dark:text-gray-400">Client: Test Client I</div>
                            <div class="text-sm font-semibold text-gray-800 dark:text-gray-200">$200,000</div>
                        </div>
                        <div class="proposal-card bg-white dark:bg-gray-900/50 p-3 mb-2 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 cursor-grab" draggable="true" data-proposal-id="test10">
                            <div class="font-medium text-gray-900 dark:text-gray-100">Test Proposal 10</div>
                            <div class="text-sm text-gray-600 dark:text-gray-400">Client: Test Client J</div>
                            <div class="text-sm font-semibold text-gray-800 dark:text-gray-200">$65,000</div>
                        </div>
                        <div class="proposal-card bg-white dark:bg-gray-900/50 p-3 mb-2 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 cursor-grab" draggable="true" data-proposal-id="test11">
                            <div class="font-medium text-gray-900 dark:text-gray-100">Test Proposal 11</div>
                            <div class="text-sm text-gray-600 dark:text-gray-400">Client: Test Client K</div>
                            <div class="text-sm font-semibold text-gray-800 dark:text-gray-200">$180,000</div>
                        </div>
                        <div class="proposal-card bg-white dark:bg-gray-900/50 p-3 mb-2 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 cursor-grab" draggable="true" data-proposal-id="test12">
                            <div class="font-medium text-gray-900 dark:text-gray-100">Test Proposal 12</div>
                            <div class="text-sm text-gray-600 dark:text-gray-400">Client: Test Client L</div>
                            <div class="text-sm font-semibold text-gray-800 dark:text-gray-200">$45,000</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Decision & Revision Row -->
        <div class="mb-6">
            <h2 class="text-xl font-bold mb-4 text-gray-900 dark:text-white">üîÑ Decision & Revision</h2>
            <div class="grid grid-cols-2 gap-4">
                <!-- For Revision -->
                <div id="forRevisionColumn" class="kanban-column bg-white dark:bg-gray-700 rounded-lg shadow">
                    <div class="drop-zone-indicator"></div>
                    <div class="kanban-column-header bg-orange-500 text-white p-3 rounded-t-lg">
                        <h3 class="font-semibold">üîÑ For Revision</h3>
                        <span class="bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-gray-200 px-2 py-1 rounded-full text-xs" id="forRevisionCount">0</span>
                    </div>
                    <div id="forRevisionBody" class="kanban-column-body p-3 min-h-64"></div>
                </div>

                <!-- No Decision Yet -->
                <div id="noDecisionColumn" class="kanban-column bg-white dark:bg-gray-700 rounded-lg shadow">
                    <div class="drop-zone-indicator"></div>
                    <div class="kanban-column-header bg-yellow-500 text-white p-3 rounded-t-lg">
                        <h3 class="font-semibold">‚è≥ No Decision Yet</h3>
                        <span class="bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-gray-200 px-2 py-1 rounded-full text-xs" id="noDecisionCount">0</span>
                    </div>
                    <div id="noDecisionBody" class="kanban-column-body p-3 min-h-64"></div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Simple drag-and-drop test implementation
        let draggedElement = null;

        // Set up drag events for test cards
        document.querySelectorAll('.proposal-card').forEach(card => {
            card.addEventListener('dragstart', (e) => {
                draggedElement = card;
                e.dataTransfer.setData('text/plain', card.dataset.proposalId);
                setTimeout(() => card.classList.add('opacity-50'), 0);
            });

            card.addEventListener('dragend', () => {
                if (draggedElement) {
                    draggedElement.classList.remove('opacity-50');
                    draggedElement = null;
                }
            });
        });

        // Set up drop zones
        document.querySelectorAll('.kanban-column-body').forEach(col => {
            col.addEventListener('dragover', e => {
                e.preventDefault();
                col.classList.add('drag-over');
                col.parentElement.classList.add('drag-over');
            });

            col.addEventListener('dragleave', e => {
                if (!col.contains(e.relatedTarget) && !col.parentElement.contains(e.relatedTarget)) {
                    col.classList.remove('drag-over');
                    col.parentElement.classList.remove('drag-over');
                }
            });

            col.addEventListener('drop', e => {
                e.preventDefault();
                col.classList.remove('drag-over');
                col.parentElement.classList.remove('drag-over');
                
                if (draggedElement) {
                    draggedElement.classList.remove('opacity-50');
                    col.appendChild(draggedElement);
                    console.log(`Moved ${draggedElement.dataset.proposalId} to ${col.id}`);
                }
            });
        });

        // Set up entire column drop zones (fallback)
        document.querySelectorAll('.kanban-column').forEach(column => {
            column.addEventListener('dragover', e => {
                e.preventDefault();
                const columnBody = column.querySelector('.kanban-column-body');
                if (columnBody && !columnBody.contains(e.target)) {
                    columnBody.classList.add('drag-over');
                    column.classList.add('drag-over');
                }
            });

            column.addEventListener('drop', e => {
                e.preventDefault();
                const columnBody = column.querySelector('.kanban-column-body');
                if (columnBody && !columnBody.contains(e.target)) {
                    if (draggedElement) {
                        draggedElement.classList.remove('opacity-50');
                        columnBody.appendChild(draggedElement);
                        console.log(`Moved ${draggedElement.dataset.proposalId} to ${columnBody.id} (via column)`);
                    }
                }
                columnBody.classList.remove('drag-over');
                column.classList.remove('drag-over');
            });
        });

        // Theme toggle
        document.getElementById('themeToggle').addEventListener('click', () => {
            document.documentElement.classList.toggle('dark');
        });
    </script>
</body>
</html> 