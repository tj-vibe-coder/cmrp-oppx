<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Executive Dashboard Filter Test</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        .test-section { margin: 20px 0; padding: 15px; border: 1px solid #ccc; }
        .test-result { margin: 10px 0; padding: 10px; }
        .success { background-color: #d4edda; border-color: #c3e6cb; }
        .error { background-color: #f8d7da; border-color: #f5c6cb; }
        .test-data { font-family: monospace; background: #f8f9fa; padding: 10px; margin: 10px 0; }
    </style>
</head>
<body>
    <h1>Executive Dashboard Filter Test</h1>
    
    <div class="test-section">
        <h2>Filter Function Tests</h2>
        <div id="filterTestResults"></div>
    </div>
    
    <div class="test-section">
        <h2>Sample Data</h2>
        <div id="sampleDataDisplay"></div>
    </div>
    
    <div class="test-section">
        <h2>Filter Results</h2>
        <div id="filterResultsDisplay"></div>
    </div>

    <script>
        // Sample test data
        const testData = [
            {
                project_name: "Project A",
                client: "Client 1",
                solutions: "Solution X",
                account_mgr: "Manager A",
                opp_status: "OP100",
                final_amt: "100000",
                date_received: "2024-01-15"
            },
            {
                project_name: "Project B",
                client: "Client 2",
                solutions: "Solution Y",
                account_mgr: "Manager B",
                opp_status: "OP90",
                final_amt: "200000",
                date_received: "2024-02-20"
            },
            {
                project_name: "Project C",
                client: "Client 3",
                solutions: "Solution X",
                account_mgr: "Manager A",
                opp_status: "OP60",
                final_amt: "150000",
                date_received: "2024-03-10"
            },
            {
                project_name: "Project D",
                client: "Client 4",
                solutions: "Solution Z",
                account_mgr: "Manager C",
                opp_status: "OP30",
                final_amt: "300000",
                date_received: "2024-04-05"
            }
        ];

        // Filter functionality (copy from executive_dashboard.js)
        let currentFilters = {
            solution: '',
            accountMgr: ''
        };

        function filterData(data) {
            if (!data || !Array.isArray(data)) return data;
            
            return data.filter(item => {
                // Solution filter
                if (currentFilters.solution && item.solutions !== currentFilters.solution) {
                    return false;
                }
                
                // Account Manager filter
                if (currentFilters.accountMgr && item.account_mgr !== currentFilters.accountMgr) {
                    return false;
                }
                
                return true;
            });
        }

        // Test functions
        function runFilterTests() {
            const results = document.getElementById('filterTestResults');
            let output = '';

            // Test 1: No filters applied
            currentFilters = { solution: '', accountMgr: '' };
            const test1Result = filterData(testData);
            output += `<div class="test-result ${test1Result.length === 4 ? 'success' : 'error'}">
                Test 1 - No Filters: ${test1Result.length === 4 ? 'PASS' : 'FAIL'} (Expected: 4, Got: ${test1Result.length})
            </div>`;

            // Test 2: Solution filter only
            currentFilters = { solution: 'Solution X', accountMgr: '' };
            const test2Result = filterData(testData);
            output += `<div class="test-result ${test2Result.length === 2 ? 'success' : 'error'}">
                Test 2 - Solution X Filter: ${test2Result.length === 2 ? 'PASS' : 'FAIL'} (Expected: 2, Got: ${test2Result.length})
            </div>`;

            // Test 3: Account Manager filter only
            currentFilters = { solution: '', accountMgr: 'Manager A' };
            const test3Result = filterData(testData);
            output += `<div class="test-result ${test3Result.length === 2 ? 'success' : 'error'}">
                Test 3 - Manager A Filter: ${test3Result.length === 2 ? 'PASS' : 'FAIL'} (Expected: 2, Got: ${test3Result.length})
            </div>`;

            // Test 4: Both filters
            currentFilters = { solution: 'Solution X', accountMgr: 'Manager A' };
            const test4Result = filterData(testData);
            output += `<div class="test-result ${test4Result.length === 2 ? 'success' : 'error'}">
                Test 4 - Both Filters: ${test4Result.length === 2 ? 'PASS' : 'FAIL'} (Expected: 2, Got: ${test4Result.length})
            </div>`;

            // Test 5: No matches
            currentFilters = { solution: 'Non-existent Solution', accountMgr: '' };
            const test5Result = filterData(testData);
            output += `<div class="test-result ${test5Result.length === 0 ? 'success' : 'error'}">
                Test 5 - No Matches: ${test5Result.length === 0 ? 'PASS' : 'FAIL'} (Expected: 0, Got: ${test5Result.length})
            </div>`;

            results.innerHTML = output;
        }

        function displaySampleData() {
            const display = document.getElementById('sampleDataDisplay');
            display.innerHTML = `<div class="test-data">${JSON.stringify(testData, null, 2)}</div>`;
        }

        function displayFilterResults() {
            const display = document.getElementById('filterResultsDisplay');
            
            // Show results for different filter combinations
            let output = '';
            
            // All data
            currentFilters = { solution: '', accountMgr: '' };
            const allData = filterData(testData);
            output += `<h3>All Data (${allData.length} items)</h3><div class="test-data">${JSON.stringify(allData, null, 2)}</div>`;
            
            // Solution X only
            currentFilters = { solution: 'Solution X', accountMgr: '' };
            const solutionXData = filterData(testData);
            output += `<h3>Solution X Only (${solutionXData.length} items)</h3><div class="test-data">${JSON.stringify(solutionXData, null, 2)}</div>`;
            
            // Manager A only
            currentFilters = { solution: '', accountMgr: 'Manager A' };
            const managerAData = filterData(testData);
            output += `<h3>Manager A Only (${managerAData.length} items)</h3><div class="test-data">${JSON.stringify(managerAData, null, 2)}</div>`;
            
            display.innerHTML = output;
        }

        // Run tests on page load
        window.addEventListener('load', () => {
            runFilterTests();
            displaySampleData();
            displayFilterResults();
        });
    </script>
</body>
</html>
