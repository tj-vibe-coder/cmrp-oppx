<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' https://cdn.jsdelivr.net https://cdn.tailwindcss.com https://cdn.sheetjs.com https://cdnjs.cloudflare.com; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com https://cdn.tailwindcss.com; font-src 'self' https://fonts.gstatic.com; img-src 'self' data:; connect-src 'self' http://localhost:3000 https://cmrp-opps-backend.onrender.com;">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <title>Proposal Engineer's Workbench - CMRP</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.4/moment.min.js"></script>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="filter-fixes.css">
    
    <!-- EMERGENCY FILTER FIX - Maximum specificity override -->
    <style>
        /* All previous override styles will be removed and handled by fix-labels.css */
    </style>
    
    <script src="config.js"></script>
    
    <!-- Include label fix script -->
    <script src="label-fix.js"></script>
</head>
<body class="bg-gray-50 dark:bg-gray-900 text-gray-800 dark:text-gray-200 min-h-screen">
    <div id="main-content" class="hidden">
        <div class="main-content">
            <div class="simple-header">
                <div class="title-group">
                    <a href="index.html" title="Go to Home" style="text-decoration: none; color: inherit;">
                        <img id="cmrpLogo" src="Logo/CMRP Logo Light.svg" alt="CMRP Logo" style="height:2.2rem;width:auto;display:inline-block;vertical-align:middle;transition:filter 0.2s;cursor:pointer;" />
                    </a>
                    <span class="subtitle">Proposal Engineer's Workbench</span>
                </div>
                <div class="flex items-center gap-2">
                    <nav class="flex gap-2" id="mainNav">
                        <a href="index.html" class="nav-square-btn" title="Opportunities Management - View and manage all opportunities"><span class="material-icons">dashboard</span></a>
                        <a href="win-loss_dashboard.html" class="nav-square-btn" title="Win-Loss Dashboard - Analyze won and lost opportunities"><span class="material-icons">line_axis</span></a>
                        <a href="forecastr_dashboard.html" class="nav-square-btn" title="Forecast Dashboard - View revenue forecasts and trends"><span class="material-icons">insights</span></a>
                        <a href="executive_dashboard.html" class="nav-square-btn" title="Executive Dashboard - Comprehensive business metrics"><span class="material-icons">analytics</span></a>
                        <a href="proposal_workbench.html" class="nav-square-btn active" id="proposalWorkbenchNavBtn" title="Proposal Engineer's Workbench - Manage proposal tasks"><span class="material-icons">view_kanban</span></a>
                        <a href="user_management.html" class="nav-square-btn" id="userMgmtNavBtn" title="User Management - Manage users and permissions (Admin only)"><span class="material-icons">group</span></a>
                    </nav>
                    <button id="themeToggle" class="nav-square-btn" title="Toggle between light and dark theme"><span class="material-icons">wb_sunny</span></button>
                    <button id="changePasswordBtn" class="nav-square-btn" title="Change your account password"><span class="material-icons">lock</span></button>
                    <button id="logoutButton" class="nav-square-btn" title="Sign out of your account"><span class="material-icons">logout</span></button>
                </div>
            </div>

        <main class="main-container mx-auto p-4 sm:p-6 lg:p-8">
            <!-- Header with View Toggle -->
            <div class="mb-6 flex justify-between items-center">
                <h2 id="pageTitle" class="text-2xl font-bold text-gray-900 dark:text-white">My Proposal Tasks</h2>
                
                <!-- View Toggle Buttons -->
                <div class="flex bg-gray-100 dark:bg-gray-800 rounded-lg p-1">
                    <button id="proposalViewBtn" class="px-4 py-2 text-sm font-medium rounded-md transition-all duration-200 bg-indigo-600 text-white shadow-sm">
                        <i class="material-icons text-sm mr-2">dashboard</i>
                        Proposal Board
                    </button>
                    <button id="scheduleViewBtn" class="px-4 py-2 text-sm font-medium rounded-md transition-all duration-200 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-700">
                        <i class="material-icons text-sm mr-2">calendar_today</i>
                        Weekly Schedule
                    </button>
                </div>
            </div>
            
            <!-- Filter section (only visible in proposal view) -->
            <div id="filterSection" class="mb-6 flex justify-end items-center">
                <div class="flex items-center space-x-4">
                    <div class="flex items-center gap-2">
                        <label for="picFilter" class="filter-label text-sm font-medium text-gray-700 dark:text-gray-300">Filter by PIC:</label>
                        <select id="picFilter" class="filter-dropdown mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md bg-white dark:bg-gray-700 dark:border-gray-600 dark:text-white">
                            <option value="">All PICs</option>
                        </select>
                    </div>
                    <div class="flex items-center gap-2">
                        <label for="clientFilter" class="filter-label text-sm font-medium text-gray-700 dark:text-gray-300">Filter by Client:</label>
                        <select id="clientFilter" class="filter-dropdown mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md bg-white dark:bg-gray-700 dark:border-gray-600 dark:text-white">
                            <option>All Clients</option>
                        </select>
                    </div>
                    <div class="flex items-center gap-2">
                        <label for="accountManagerFilter" class="filter-label text-sm font-medium text-gray-700 dark:text-gray-300">Filter by Account Manager:</label>
                        <select id="accountManagerFilter" class="filter-dropdown mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md bg-white dark:bg-gray-700 dark:border-gray-600 dark:text-white">
                            <option>All Account Managers</option>
                        </select>
                    </div>
                </div>
            </div>
            
            <!-- Proposal Board View -->
            <div id="proposalView" class="">
                <!-- Kanban Board -->
                <div class="mb-8">
                <h2 class="text-xl font-bold mb-4 text-gray-900 dark:text-white">Proposal Status Board</h2>
                
                <!-- Main Workflow Row -->
                <div class="mb-4">
                    <h3 class="text-sm font-medium text-gray-600 dark:text-gray-400 mb-2">Main Workflow</h3>
                    <div id="kanbanBoard" class="kanban-board grid grid-cols-1 md:grid-cols-3 lg:grid-cols-5 gap-4">
                        <!-- Not Yet Started Column -->
                        <div id="notStartedColumn" class="kanban-column bg-gray-100 dark:bg-gray-800 rounded-lg shadow">
                            <div class="kanban-column-header flex justify-between items-center p-3 font-semibold text-gray-700 dark:text-gray-200 border-b border-gray-200 dark:border-gray-700">
                                <span><i class="material-icons text-sm mr-2">hourglass_empty</i>Not Yet Started</span>
                                <span id="notStartedCount" class="bg-gray-200 dark:bg-gray-700 text-xs font-semibold px-2 py-1 rounded-full">0</span>
                            </div>
                            <div id="notStartedBody" class="kanban-column-body p-3 space-y-3">
                                <!-- Proposal cards will be dynamically inserted here -->
                            </div>
                        </div>

                        <!-- On-going Column -->
                        <div id="ongoingColumn" class="kanban-column bg-gray-100 dark:bg-gray-800 rounded-lg shadow">
                            <div class="kanban-column-header flex justify-between items-center p-3 font-semibold text-gray-700 dark:text-gray-200 border-b border-gray-200 dark:border-gray-700">
                                <span><i class="material-icons text-sm mr-2">trending_up</i>On-going</span>
                                <span id="ongoingCount" class="bg-gray-200 dark:bg-gray-700 text-xs font-semibold px-2 py-1 rounded-full">0</span>
                            </div>
                            <div id="ongoingBody" class="kanban-column-body p-3 space-y-3">
                                <!-- Proposal cards will be dynamically inserted here -->
                            </div>
                        </div>

                        <!-- For Revision Column -->
                        <div id="forRevisionColumn" class="kanban-column bg-orange-50 dark:bg-orange-900/20 rounded-lg shadow border-l-4 border-orange-400">
                            <div class="kanban-column-header flex justify-between items-center p-3 font-semibold text-gray-700 dark:text-gray-200 border-b border-orange-200 dark:border-orange-700">
                                <span><i class="material-icons text-sm mr-2 text-orange-600">edit</i>For Revision</span>
                                <span id="forRevisionCount" class="bg-orange-200 dark:bg-orange-700 text-xs font-semibold px-2 py-1 rounded-full">0</span>
                            </div>
                            <div id="forRevisionBody" class="kanban-column-body p-3 space-y-3">
                                <!-- Proposal cards will be dynamically inserted here -->
                            </div>
                        </div>

                        <!-- For Approval Column -->
                        <div id="forApprovalColumn" class="kanban-column bg-gray-100 dark:bg-gray-800 rounded-lg shadow">
                            <div class="kanban-column-header flex justify-between items-center p-3 font-semibold text-gray-700 dark:text-gray-200 border-b border-gray-200 dark:border-gray-700">
                                <span><i class="material-icons text-sm mr-2">gavel</i>For Approval</span>
                                <span id="forApprovalCount" class="bg-gray-200 dark:bg-gray-700 text-xs font-semibold px-2 py-1 rounded-full">0</span>
                            </div>
                            <div id="forApprovalBody" class="kanban-column-body p-3 space-y-3">
                                <!-- Proposal cards will be dynamically inserted here -->
                            </div>
                        </div>

                        <!-- Submitted Column -->
                        <div id="submittedColumn" class="kanban-column bg-gray-100 dark:bg-gray-800 rounded-lg shadow">
                            <div class="kanban-column-header flex justify-between items-center p-3 font-semibold text-gray-700 dark:text-gray-200 border-b border-gray-200 dark:border-gray-700">
                                <span><i class="material-icons text-sm mr-2">check_circle</i>Submitted</span>
                                <div class="flex items-center">
                                    <span id="submittedCount" class="bg-gray-200 dark:bg-gray-700 text-xs font-semibold px-2 py-1 rounded-full mr-2">0</span>
                                    <label for="hideOldSubmitted" class="flex items-center text-xs cursor-pointer">
                                        <input type="checkbox" id="hideOldSubmitted" class="h-4 w-4 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500 mr-1" checked>
                                        Last 10 only
                                    </label>
                                </div>
                            </div>
                            <div id="submittedBody" class="kanban-column-body p-3 space-y-3">
                                <!-- Proposal cards will be dynamically inserted here -->
                            </div>
                        </div>
                    </div>
                </div>

                <!-- No Decision Yet Toggle Button - ENHANCED VISIBILITY -->
                <div class="mb-6 flex justify-center bg-yellow-100 dark:bg-yellow-900/30 p-4 rounded-lg border border-yellow-300 dark:border-yellow-600">
                    <button id="noDecisionToggleBtn" class="inline-flex items-center px-6 py-3 border border-yellow-400 text-base font-semibold rounded-lg shadow-lg text-yellow-800 bg-yellow-200 hover:bg-yellow-300 dark:bg-yellow-900/40 dark:text-yellow-200 dark:border-yellow-500 dark:hover:bg-yellow-900/60 transition-all duration-200 transform hover:scale-105">
                        <i class="material-icons text-lg mr-2">help_outline</i>
                        No Decision Yet (<span id="noDecisionCount">0</span>)
                    </button>
                </div>
            </div>
            
            <!-- Weekly Schedule View -->
            <div id="scheduleView" class="hidden">
                <!-- Add Proposal to Schedule Button -->
                <div class="mb-6 flex justify-center">
                    <button id="addProposalToScheduleBtn" class="inline-flex items-center px-6 py-3 border border-transparent text-base font-medium rounded-lg shadow-lg text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition-all duration-200">
                        <i class="material-icons text-lg mr-2">add_circle</i>
                        Add Proposal to Schedule
                    </button>
                </div>

            <!-- Weekly Schedule -->
            <div class="mt-8">
                <div class="flex justify-between items-center mb-4">
                    <h2 class="text-2xl font-bold text-gray-900 dark:text-white">Weekly Schedule</h2>
                    <div class="flex items-center space-x-4">
                        <div id="week-navigation" class="flex items-center space-x-2">
                            <button id="prev-week-btn" class="p-2 rounded-full text-gray-500 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700">
                                <span class="material-icons">chevron_left</span>
                            </button>
                            <span id="current-week-display" class="text-sm font-medium text-gray-700 dark:text-gray-300">Current Week</span>
                            <button id="next-week-btn" class="p-2 rounded-full text-gray-500 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700">
                                <span class="material-icons">chevron_right</span>
                            </button>
                            <button id="current-week-btn" class="text-sm font-medium text-indigo-600 hover:text-indigo-500">Today</button>
                        </div>
                        <div class="flex items-center">
                            <input type="checkbox" id="weekend-toggle" class="h-4 w-4 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500" checked>
                            <label for="weekend-toggle" class="ml-2 block text-sm text-gray-900 dark:text-gray-300">Include weekends</label>
                        </div>
                        <button id="addTaskBtn" class="inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500">
                            <span class="material-icons -ml-1 mr-2">add</span>
                            Add Task
                        </button>
                    </div>
                </div>
                <div class="schedule-container overflow-x-auto pb-2">
                    <p class="text-xs text-gray-500 dark:text-gray-400 italic mb-2">Scroll horizontally to see all days of the week.</p>
                    <div id="schedule" class="schedule-board grid grid-cols-7 gap-1">
                        <div id="scheduleHeaderRow" class="contents">
                            <!-- Day headers will be injected here -->
                        </div>
                        <div id="scheduleBodyRow" class="contents">
                            <!-- Day columns will be injected here -->
                        </div>
                    </div>
                </div>
            </div>
            </div> <!-- End scheduleView -->
            </div> <!-- End proposalView -->
        </main>
    </div>

    <!-- Proposal Edit Modal -->
    <div id="proposalEditModal" class="fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full hidden" aria-labelledby="modal-title" role="dialog" aria-modal="true">
        <div class="mx-auto mt-24 p-5 border w-1/2 shadow-lg rounded-md bg-white dark:bg-gray-800">
            <div class="mt-3 text-center">
                <h3 class="text-lg leading-6 font-medium text-gray-900 dark:text-white" id="modal-title">Edit Proposal</h3>
                <div class="mt-2 px-7 py-3">
                    <form id="proposalEditForm">
                        <input type="hidden" id="editProposalId">
                        <div class="mb-4">
                            <label for="editProposalName" class="block text-sm font-medium text-gray-700 dark:text-gray-300 text-left">Project Name</label>
                            <input type="text" id="editProposalName" class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm dark:bg-gray-700 dark:border-gray-600 dark:text-white" readonly>
                        </div>
                        <div class="mb-4">
                            <label for="editComment" class="block text-sm font-medium text-gray-700 dark:text-gray-300 text-left">Add/Edit Comment</label>
                            <textarea id="editComment" rows="3" class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm dark:bg-gray-700 dark:border-gray-600 dark:text-white"></textarea>
                        </div>
                        <div class="items-center px-4 py-3">
                            <button id="saveProposalChanges" type="submit" class="px-4 py-2 bg-indigo-500 text-white text-base font-medium rounded-md w-auto shadow-sm hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500">Save</button>
                            <button id="cancelProposalEdit" type="button" class="px-4 py-2 bg-gray-200 text-gray-800 text-base font-medium rounded-md w-auto shadow-sm hover:bg-gray-300 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-200 ml-2">Cancel</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Task Modal -->
    <div id="taskModalOverlay" class="fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full hidden">
        <div class="modal-content mx-auto mt-16 p-6 border rounded-lg shadow-xl bg-white dark:bg-gray-800">
            <div class="flex justify-between items-center mb-4">
                <h3 id="taskModalTitle" class="text-lg font-medium text-gray-900 dark:text-white">Add Task</h3>
                <button id="closeTaskModalBtn" class="text-gray-400 hover:text-gray-600 dark:hover:text-gray-200">
                    <span class="material-icons">close</span>
                </button>
            </div>
            <form id="taskForm">
                <input type="hidden" id="taskId">
                <input type="hidden" id="taskIsEdit" value="false">
                <input type="hidden" id="taskDayIndex">
                
                <div class="form-group">
                    <label for="taskTitle" class="block text-sm font-medium text-gray-700 dark:text-gray-300">Title</label>
                    <input type="text" id="taskTitle" class="mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm dark:bg-gray-700 dark:text-white" required>
                </div>
                
                <div class="form-group">
                    <label for="taskDescription" class="block text-sm font-medium text-gray-700 dark:text-gray-300">Description</label>
                    <textarea id="taskDescription" rows="2" class="mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm dark:bg-gray-700 dark:text-white"></textarea>
                </div>

                <div class="form-group grid grid-cols-2 gap-4">
                    <div>
                        <label for="taskDay" class="block text-sm font-medium text-gray-700 dark:text-gray-300">Day of Week</label>
                        <select id="taskDay" class="mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm dark:bg-gray-700 dark:text-white">
                            <option value="0">Sunday</option>
                            <option value="1">Monday</option>
                            <option value="2">Tuesday</option>
                            <option value="3">Wednesday</option>
                            <option value="4">Thursday</option>
                            <option value="5">Friday</option>
                            <option value="6">Saturday</option>
                        </select>
                    </div>
                    <div>
                        <label for="taskTime" class="block text-sm font-medium text-gray-700 dark:text-gray-300">Time</label>
                        <input type="time" id="taskTime" class="mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm dark:bg-gray-700 dark:text-white">
                        <div class="mt-2 flex items-center">
                            <input type="checkbox" id="taskIsAllDay" class="h-4 w-4 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500">
                            <label for="taskIsAllDay" class="ml-2 text-sm text-gray-700 dark:text-gray-300">All Day</label>
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    <label for="taskComment" class="block text-sm font-medium text-gray-700 dark:text-gray-300">Comment</label>
                    <textarea id="taskComment" rows="2" class="mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm dark:bg-gray-700 dark:text-white"></textarea>
                </div>

                <div class="flex justify-end space-x-3 mt-6">
                    <button id="cancelTaskBtn" type="button" class="px-4 py-2 bg-gray-200 text-gray-800 rounded-md hover:bg-gray-300">Cancel</button>
                    <button type="submit" class="px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700">Save Task</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Proposal Selection Modal for Scheduling -->
    <div id="proposalSelectionModal" class="fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full hidden z-50" aria-labelledby="proposal-selection-title" role="dialog" aria-modal="true">
        <div class="modal-content mx-auto mt-16 p-6 border rounded-lg shadow-xl bg-white dark:bg-gray-800 w-2/3 max-w-4xl max-h-[80vh] overflow-y-auto">
            <div class="flex justify-between items-center mb-4">
                <h3 id="proposal-selection-title" class="text-lg font-medium text-gray-900 dark:text-white">
                    <i class="material-icons text-sm mr-2">add_circle</i>Select Proposal to Add to Schedule
                </h3>
                <button id="closeProposalSelectionBtn" class="text-gray-400 hover:text-gray-600 dark:hover:text-gray-200">
                    <span class="material-icons">close</span>
                </button>
            </div>
            
            <!-- Search and Filter -->
            <div class="mb-4 flex gap-4">
                <input type="text" id="proposalSearchInput" class="flex-1 px-3 py-2 border border-gray-300 rounded-md focus:ring-indigo-500 focus:border-indigo-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white" placeholder="Search proposals...">
                <select id="proposalStatusFilter" class="px-3 py-2 border border-gray-300 rounded-md focus:ring-indigo-500 focus:border-indigo-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white">
                    <option value="">All Statuses</option>
                    <option value="not_yet_started">Not Yet Started</option>
                    <option value="ongoing">Ongoing</option>
                    <option value="for_revision">For Revision</option>
                    <option value="for_approval">For Approval</option>
                    <option value="submitted">Submitted</option>
                </select>
            </div>
            
            <!-- Proposal List -->
            <div id="proposalSelectionList" class="space-y-2 max-h-96 overflow-y-auto">
                <!-- Proposal items will be dynamically inserted here -->
            </div>
        </div>
    </div>

    <!-- No Decision Yet Modal -->
    <div id="noDecisionModal" class="fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full hidden z-50" aria-labelledby="no-decision-title" role="dialog" aria-modal="true">
        <div id="noDecisionModalContent" class="modal-content mx-auto mt-16 p-6 border rounded-lg shadow-xl bg-yellow-50 dark:bg-yellow-900/20 border-yellow-400 w-96 max-w-md cursor-move">
            <div class="flex justify-between items-center mb-4">
                <h3 id="no-decision-title" class="text-lg font-medium text-yellow-800 dark:text-yellow-300">
                    <i class="material-icons text-sm mr-2">help_outline</i>No Decision Yet
                </h3>
                <button id="closeNoDecisionBtn" class="text-yellow-600 hover:text-yellow-800 dark:text-yellow-400 dark:hover:text-yellow-200">
                    <span class="material-icons">close</span>
                </button>
            </div>
            <div id="noDecisionBody" class="kanban-column-body max-h-80 overflow-y-auto p-2 space-y-2">
                <!-- No Decision proposals will be dynamically inserted here -->
            </div>
        </div>
    </div>

    <!-- Auth loading screen -->
    <div id="auth-loading-screen" class="fixed inset-0 bg-gray-100 dark:bg-gray-900 flex items-center justify-center z-50">
        <div class="text-center">
            <svg class="animate-spin h-10 w-10 text-indigo-600 mx-auto mb-4" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
            </svg>
            <p class="text-lg font-medium text-gray-700 dark:text-gray-300">Authenticating...</p>
        </div>
    </div>
    
    <!-- Find the schedule header template and add inline styles -->
    <div id="scheduleTemplate" style="display: none;">
        <div id="day-header-{index}" class="schedule-header relative p-2 rounded-t-lg text-center font-semibold text-sm {weekend}">
            <div class="day-name" style="color: white !important; font-weight: 500 !important;">{dayName}</div>
            <div class="day-date text-xs font-normal" style="color: white !important;">{date}</div>
            {today}
        </div>
        <div id="day-column-{index}" class="day-column bg-white dark:bg-gray-700 p-2 min-h-[150px] rounded-b-lg">
        </div>
    </div>
    
    <script src="proposal_workbench.js"></script>
</body>
</html> 